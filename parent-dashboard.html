<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèîÔ∏è Bedrock ELA - Family Command Center</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: #FFFFFF;
            min-height: 100vh;
            color: #1B2A30;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 20px 0;
            box-shadow: 0 2px 20px rgba(0,0,0,0.1);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            font-size: 1.5rem;
            font-weight: bold;
            color: #1B2A30;
        }
        
        .logo span {
            font-size: 2rem;
            margin-right: 10px;
        }
        
        .parent-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .parent-badge {
            background: linear-gradient(135deg, #305853 0%, #1B2A30 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
        }
        
        .signout-btn {
            background: #9E2C21;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .signout-btn:hover {
            background: #511B18;
            transform: translateY(-2px);
        }
        
        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }
        
        .welcome-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        .section-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.5rem;
            font-weight: bold;
            color: #1B2A30;
            margin-bottom: 20px;
        }
        
        .students-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
        }
        
        .student-card {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            border-left: 5px solid #305853;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .student-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .student-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .student-name {
            font-size: 1.3rem;
            font-weight: bold;
            color: #1B2A30;
        }
        
        .student-grade {
            background: #305853;
            color: white;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: bold;
        }
        
        .student-stats {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .mini-stat {
            text-align: center;
            flex: 1;
        }
        
        .mini-stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            color: #305853;
        }
        
        .mini-stat-label {
            font-size: 0.8rem;
            color: #666;
            margin-top: 2px;
        }
        
        .student-progress {
            margin-bottom: 15px;
        }
        
        .progress-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }
        
        .progress-bar {
            background: #e9ecef;
            border-radius: 10px;
            height: 8px;
            overflow: hidden;
        }
        
        .progress-fill {
            background: linear-gradient(90deg, #305853 0%, #1B2A30 100%);
            height: 100%;
            border-radius: 10px;
            transition: width 0.3s ease;
        }
        
        .student-actions {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
        }
        
        .action-btn {
            background: linear-gradient(135deg, #B06821 0%, #9E2C21 100%);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        
        .action-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(176,104,33,0.4);
        }
        
        .action-btn.secondary {
            background: #1B2A30;
        }

        .action-btn.credentials {
            background: #305853;
            font-size: 0.75rem;
            padding: 6px 12px;
        }

        .action-btn.credentials:hover {
            background: #B06821;
        }

        .action-btn.edit {
            background: #305853;
            font-size: 0.75rem;
            padding: 6px 12px;
        }

        .action-btn.edit:hover {
            background: #1B2A30;
        }

        .action-btn.delete {
            background: #9E2C21;
            font-size: 0.75rem;
            padding: 6px 12px;
        }

        .action-btn.delete:hover {
            background: #511B18;
        }
        
        /* Mobile Responsive Improvements */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
                padding: 0 15px;
            }
            
            .logo {
                font-size: 1.2rem;
            }
            
            .logo span {
                font-size: 1.5rem;
            }
            
            .dashboard-container {
                padding: 20px 15px;
            }
            
            .welcome-section {
                padding: 20px;
                margin-bottom: 20px;
            }
            
            .welcome-section h1 {
                font-size: 1.5rem;
                text-align: center;
            }
            
            .welcome-section p {
                font-size: 1rem;
                text-align: center;
            }
            
            .students-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
            
            .student-card {
                padding: 15px;
            }
            
            .student-name {
                font-size: 1.1rem;
            }
            
            .student-grade {
                font-size: 0.8rem;
                padding: 4px 8px;
            }
            
            .mini-stat-number {
                font-size: 1.3rem;
            }
            
            .mini-stat-label {
                font-size: 0.75rem;
            }
            
            .student-actions {
                flex-wrap: wrap;
                gap: 6px;
            }
            
            .action-btn {
                font-size: 0.7rem;
                padding: 6px 10px;
                border-radius: 15px;
                margin: 2px;
            }
            
            .action-btn.credentials,
            .action-btn.edit,
            .action-btn.delete {
                font-size: 0.65rem;
                padding: 5px 8px;
            }
            
            .section-title {
                font-size: 1.3rem;
                margin-bottom: 15px;
                text-align: center;
            }
        }

        @media (max-width: 480px) {
            .dashboard-container {
                padding: 15px 10px;
            }
            
            .welcome-section {
                padding: 15px;
            }
            
            .welcome-section h1 {
                font-size: 1.3rem;
            }
            
            .student-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
                margin-bottom: 12px;
            }
            
            .student-stats {
                gap: 8px;
                margin-bottom: 12px;
            }
            
            .mini-stat {
                flex: 1;
                min-width: 60px;
            }
            
            .action-btn {
                font-size: 0.6rem;
                padding: 4px 8px;
                margin: 1px;
            }
            
            .action-btn.credentials,
            .action-btn.edit,
            .action-btn.delete {
                font-size: 0.6rem;
                padding: 4px 6px;
            }
            
            .section-title {
                font-size: 1.2rem;
            }
            
            .parent-info {
                font-size: 0.8rem;
                padding: 8px 15px;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <span>üèîÔ∏èüêê</span>
                <div>
                    <div style="font-size: 1.2rem;">Bedrock ELA</div>
                    <div style="font-size: 0.8rem; opacity: 0.7;">Family Command Center</div>
                </div>
            </div>
            <div class="parent-info">
                <div class="parent-badge" id="parentBadge">
                    <span style="margin-right: 10px;">üëë</span>
                    <span id="parentName">Loading...</span>
                </div>
                <button class="signout-btn" onclick="signOut()">Sign Out</button>
            </div>
        </div>
    </header>

    <div class="dashboard-container">
        <!-- Welcome Section -->
        <div class="welcome-section">
            <h1 style="color: #1B2A30; margin-bottom: 10px;">Welcome to Your Family Command Center! üëë</h1>
            <p style="font-size: 1.1rem; color: #1B2A30;">Monitor your little climbers' progress through the Norwegian mountains</p>
        </div>

        <!-- Students Section -->
        <div class="students-section">
            <h2 class="section-title">
                <span>üê≤</span>
                Your Mountain Climbers
            </h2>
            
            <div class="students-grid">
                <!-- Emmett -->
                <div class="student-card">
                    <div class="student-header">
                        <div class="student-name">üêê Emmett (6)</div>
                        <div class="student-grade">1st Grade</div>
                    </div>
                    <div class="student-stats">
                        <div class="mini-stat">
                            <div class="mini-stat-number">25</div>
                            <div class="mini-stat-label">Min Today</div>
                        </div>
                        <div class="mini-stat">
                            <div class="mini-stat-number">3</div>
                            <div class="mini-stat-label">Peaks</div>
                        </div>
                        <div class="mini-stat">
                            <div class="mini-stat-number">‚≠ê</div>
                            <div class="mini-stat-label">Great!</div>
                        </div>
                    </div>
                    <div class="student-progress">
                        <div class="progress-label">
                            <span>Daily Progress</span>
                            <span>4/5 quests</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 80%"></div>
                        </div>
                    </div>
                    <div class="student-actions">
                        <button class="action-btn">View Dashboard</button>
                        <button class="action-btn">Current Lesson</button>
                        <button class="action-btn secondary">Messages</button>
                        <button onclick="showLogin('emmett', 'Emmett')" class="action-btn credentials">üîë Login</button>
                        <button onclick="managePIN('emmett', 'Emmett')" class="action-btn credentials">üîí Set PIN</button>
                        <button onclick="editStudent('emmett', 'Emmett', 6, '1st Grade')" class="action-btn edit">‚úèÔ∏è Edit</button>
                        <button onclick="deleteStudent('emmett', 'Emmett')" class="action-btn delete">üóëÔ∏è Delete</button>
                    </div>
                </div>

                <!-- Lucas -->
                <div class="student-card">
                    <div class="student-header">
                        <div class="student-name">üêê Lucas (11)</div>
                        <div class="student-grade">4th Grade</div>
                    </div>
                    <div class="student-stats">
                        <div class="mini-stat">
                            <div class="mini-stat-number">45</div>
                            <div class="mini-stat-label">Min Today</div>
                        </div>
                        <div class="mini-stat">
                            <div class="mini-stat-number">2</div>
                            <div class="mini-stat-label">Peaks</div>
                        </div>
                        <div class="mini-stat">
                            <div class="mini-stat-number">üéØ</div>
                            <div class="mini-stat-label">Focus</div>
                        </div>
                    </div>
                    <div class="student-progress">
                        <div class="progress-label">
                            <span>Daily Progress</span>
                            <span>2/4 quests</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 50%"></div>
                        </div>
                    </div>
                    <div class="student-actions">
                        <button class="action-btn">View Dashboard</button>
                        <button class="action-btn">Current Lesson</button>
                        <button class="action-btn secondary">Messages</button>
                        <button onclick="showLogin('lucas', 'Lucas')" class="action-btn credentials">üîë Login</button>
                        <button onclick="managePIN('lucas', 'Lucas')" class="action-btn credentials">üîí Set PIN</button>
                        <button onclick="editStudent('lucas', 'Lucas', 11, '4th Grade')" class="action-btn edit">‚úèÔ∏è Edit</button>
                        <button onclick="deleteStudent('lucas', 'Lucas')" class="action-btn delete">üóëÔ∏è Delete</button>
                    </div>
                </div>

                <!-- Asher -->
                <div class="student-card">
                    <div class="student-header">
                        <div class="student-name">üêê Asher (9)</div>
                        <div class="student-grade">3rd Grade</div>
                    </div>
                    <div class="student-stats">
                        <div class="mini-stat">
                            <div class="mini-stat-number">0</div>
                            <div class="mini-stat-label">Min Today</div>
                        </div>
                        <div class="mini-stat">
                            <div class="mini-stat-number">0</div>
                            <div class="mini-stat-label">Peaks</div>
                        </div>
                        <div class="mini-stat">
                            <div class="mini-stat-number">üí§</div>
                            <div class="mini-stat-label">Not Started</div>
                        </div>
                    </div>
                    <div class="student-progress">
                        <div class="progress-label">
                            <span>Daily Progress</span>
                            <span>0/4 quests</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 0%"></div>
                        </div>
                    </div>
                    <div class="student-actions">
                        <button class="action-btn">View Dashboard</button>
                        <button class="action-btn secondary">Coming Soon</button>
                        <button class="action-btn secondary">Remind</button>
                        <button onclick="showLogin('asher', 'Asher')" class="action-btn credentials">üîë Login</button>
                        <button onclick="managePIN('asher', 'Asher')" class="action-btn credentials">üîí Set PIN</button>
                        <button onclick="editStudent('asher', 'Asher', 9, '3rd Grade')" class="action-btn edit">‚úèÔ∏è Edit</button>
                        <button onclick="deleteStudent('asher', 'Asher')" class="action-btn delete">üóëÔ∏è Delete</button>
                    </div>
                </div>

                <!-- Levi -->
                <div class="student-card">
                    <div class="student-header">
                        <div class="student-name">üêê Levi (13)</div>
                        <div class="student-grade">6th Grade</div>
                    </div>
                    <div class="student-stats">
                        <div class="mini-stat">
                            <div class="mini-stat-number">35</div>
                            <div class="mini-stat-label">Min Today</div>
                        </div>
                        <div class="mini-stat">
                            <div class="mini-stat-number">1</div>
                            <div class="mini-stat-label">Peaks</div>
                        </div>
                        <div class="mini-stat">
                            <div class="mini-stat-number">üöÄ</div>
                            <div class="mini-stat-label">Advanced</div>
                        </div>
                    </div>
                    <div class="student-progress">
                        <div class="progress-label">
                            <span>Daily Progress</span>
                            <span>1/3 quests</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 33%"></div>
                        </div>
                    </div>
                    <div class="student-actions">
                        <button class="action-btn">View Dashboard</button>
                        <button class="action-btn secondary">Coming Soon</button>
                        <button class="action-btn secondary">Messages</button>
                        <button onclick="showLogin('levi', 'Levi')" class="action-btn credentials">üîë Login</button>
                        <button onclick="managePIN('levi', 'Levi')" class="action-btn credentials">üîí Set PIN</button>
                        <button onclick="editStudent('levi', 'Levi', 13, '6th Grade')" class="action-btn edit">‚úèÔ∏è Edit</button>
                        <button onclick="deleteStudent('levi', 'Levi')" class="action-btn delete">üóëÔ∏è Delete</button>
                    </div>
                </div>

                <!-- Riley -->
                <div class="student-card">
                    <div class="student-header">
                        <div class="student-name">üêê Riley (14)</div>
                        <div class="student-grade">7th Grade</div>
                    </div>
                    <div class="student-stats">
                        <div class="mini-stat">
                            <div class="mini-stat-number">50</div>
                            <div class="mini-stat-label">Min Today</div>
                        </div>
                        <div class="mini-stat">
                            <div class="mini-stat-number">3</div>
                            <div class="mini-stat-label">Peaks</div>
                        </div>
                        <div class="mini-stat">
                            <div class="mini-stat-number">üëë</div>
                            <div class="mini-stat-label">Leader</div>
                        </div>
                    </div>
                    <div class="student-progress">
                        <div class="progress-label">
                            <span>Daily Progress</span>
                            <span>3/3 quests</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 100%"></div>
                        </div>
                    </div>
                    <div class="student-actions">
                        <button class="action-btn">View Dashboard</button>
                        <button class="action-btn secondary">Coming Soon</button>
                        <button class="action-btn secondary">Messages</button>
                        <button onclick="showLogin('riley', 'Riley')" class="action-btn credentials">üîë Login</button>
                        <button onclick="managePIN('riley', 'Riley')" class="action-btn credentials">üîí Set PIN</button>
                        <button onclick="editStudent('riley', 'Riley', 14, '7th Grade')" class="action-btn edit">‚úèÔ∏è Edit</button>
                        <button onclick="deleteStudent('riley', 'Riley')" class="action-btn delete">üóëÔ∏è Delete</button>
                    </div>
                </div>

                <!-- Bryton -->
                <div class="student-card">
                    <div class="student-header">
                        <div class="student-name">üêê Bryton (16)</div>
                        <div class="student-grade">College Prep</div>
                    </div>
                    <div class="student-stats">
                        <div class="mini-stat">
                            <div class="mini-stat-number">60</div>
                            <div class="mini-stat-label">Min Today</div>
                        </div>
                        <div class="mini-stat">
                            <div class="mini-stat-number">2</div>
                            <div class="mini-stat-label">Peaks</div>
                        </div>
                        <div class="mini-stat">
                            <div class="mini-stat-number">üéì</div>
                            <div class="mini-stat-label">Scholar</div>
                        </div>
                    </div>
                    <div class="student-progress">
                        <div class="progress-label">
                            <span>Daily Progress</span>
                            <span>2/3 quests</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: 67%"></div>
                        </div>
                    </div>
                    <div class="student-actions">
                        <button class="action-btn">View Dashboard</button>
                        <button class="action-btn secondary">Coming Soon</button>
                        <button class="action-btn secondary">Messages</button>
                        <button onclick="showLogin('bryton', 'Bryton')" class="action-btn credentials">üîë Login</button>
                        <button onclick="managePIN('bryton', 'Bryton')" class="action-btn credentials">üîí Set PIN</button>
                        <button onclick="editStudent('bryton', 'Bryton', 16, 'College Prep')" class="action-btn edit">‚úèÔ∏è Edit</button>
                        <button onclick="deleteStudent('bryton', 'Bryton')" class="action-btn delete">üóëÔ∏è Delete</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Simple, working JavaScript functions
        console.log('JavaScript loaded successfully');
        
        // Load parent info on page load
        const parentData = JSON.parse(localStorage.getItem('bedrockela_parent') || '{}');
        const token = localStorage.getItem('bedrockela_token');
        
        // Redirect if not logged in
        if (!parentData.id || !token) {
            window.location.href = 'parent-login.html';
        }
        
        // Display parent name
        if (parentData.name) {
            document.getElementById('parentName').textContent = parentData.name;
        }
        
        // Sign out function
        function signOut() {
            if (confirm('Sign out of BedrockELA?')) {
                localStorage.removeItem('bedrockela_token');
                localStorage.removeItem('bedrockela_parent');
                localStorage.removeItem('bedrockela_student');
                window.location.href = 'index.html';
            }
        }
        
        // Show login credentials
        function showLogin(studentId, studentName) {
            console.log('Login clicked for:', studentName);
            
            const username = studentName.toLowerCase();
            const password = username + '123';
            const loginUrl = window.location.origin + '/mountain-student-signin.html';
            
            const modal = document.createElement('div');
            modal.id = 'loginModal';
            modal.style.position = 'fixed';
            modal.style.top = '0';
            modal.style.left = '0';
            modal.style.width = '100%';
            modal.style.height = '100%';
            modal.style.background = 'rgba(0,0,0,0.8)';
            modal.style.display = 'flex';
            modal.style.justifyContent = 'center';
            modal.style.alignItems = 'center';
            modal.style.zIndex = '10001';
            
            const content = document.createElement('div');
            content.style.background = 'white';
            content.style.borderRadius = '20px';
            content.style.padding = '30px';
            content.style.maxWidth = '500px';
            content.style.width = '90%';
            
            content.innerHTML = 
                '<h2 style="margin: 0 0 20px 0; color: #1B2A30;">üîë Login Credentials: ' + studentName + '</h2>' +
                '<div style="background: #f8f9fa; border-radius: 15px; padding: 20px; margin: 20px 0;">' +
                '<div style="margin-bottom: 15px;"><strong>üë§ Username:</strong><br><code style="background: white; padding: 8px 12px; border-radius: 8px; border: 1px solid #dee2e6; font-size: 16px;">' + username + '</code></div>' +
                '<div style="margin-bottom: 15px;"><strong>üîê Password:</strong><br><code style="background: white; padding: 8px 12px; border-radius: 8px; border: 1px solid #dee2e6; font-size: 16px;">' + password + '</code></div>' +
                '<div><strong>üåê Login URL:</strong><br><code style="background: white; padding: 8px 12px; border-radius: 8px; border: 1px solid #dee2e6; font-size: 12px; word-break: break-all;">' + loginUrl + '</code></div>' +
                '</div>' +
                '<div style="display: flex; gap: 15px; justify-content: center;">' +
                '<button onclick="window.open(\'' + loginUrl + '\', \'_blank\')" style="background: #305853; color: white; border: none; padding: 12px 25px; border-radius: 8px; cursor: pointer; font-weight: bold;">üöÄ Test Login</button>' +
                '<button onclick="closeModal()" style="background: #1B2A30; color: white; border: none; padding: 12px 25px; border-radius: 8px; cursor: pointer; font-weight: bold;">Close</button>' +
                '</div>' +
                '<div style="background: #e7f3ff; border-radius: 10px; padding: 15px; margin-top: 15px; font-size: 14px; color: #004085;"><strong>üõ°Ô∏è Security Note:</strong> Demo mode - any password works for any username!</div>';
                
            modal.appendChild(content);
            document.body.appendChild(modal);
        }
        
        // Manage PIN
        function managePIN(studentId, studentName) {
            console.log('Manage PIN clicked for:', studentName);
            
            const modal = document.createElement('div');
            modal.id = 'pinModal';
            modal.style.position = 'fixed';
            modal.style.top = '0';
            modal.style.left = '0';
            modal.style.width = '100%';
            modal.style.height = '100%';
            modal.style.background = 'rgba(0,0,0,0.8)';
            modal.style.display = 'flex';
            modal.style.justifyContent = 'center';
            modal.style.alignItems = 'center';
            modal.style.zIndex = '10001';
            
            const content = document.createElement('div');
            content.style.background = 'white';
            content.style.borderRadius = '20px';
            content.style.padding = '30px';
            content.style.maxWidth = '450px';
            content.style.width = '90%';
            
            content.innerHTML = 
                '<h2 style="margin: 0 0 15px 0; color: #1B2A30;">üîí Manage PIN for ' + studentName + '</h2>' +
                '<p style="color: #666; margin-bottom: 25px;">Set a 4-digit PIN that ' + studentName + ' will need to enter when logging in.</p>' +
                '<div style="margin-bottom: 20px;">' +
                '<label style="display: block; font-weight: bold; margin-bottom: 8px; color: #1B2A30;">New PIN (4 digits):</label>' +
                '<input type="password" id="newPIN" maxlength="4" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" style="width: 100%; padding: 15px; border: 2px solid #e0e0e0; border-radius: 10px; font-size: 1.5rem; text-align: center; letter-spacing: 10px;">' +
                '</div>' +
                '<div style="background: #e7f3ff; border-radius: 10px; padding: 15px; margin-bottom: 20px; font-size: 14px; color: #004085;">' +
                '<strong>üí° Tip:</strong> Choose a PIN ' + studentName + ' can remember easily!' +
                '</div>' +
                '<div style="display: flex; gap: 10px;">' +
                '<button onclick="savePIN(\'' + studentId + '\', \'' + studentName + '\')" style="flex: 1; background: #305853; color: white; border: none; padding: 15px 20px; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 1rem;">Save PIN</button>' +
                '<button onclick="removePIN(\'' + studentId + '\', \'' + studentName + '\')" style="background: #9E2C21; color: white; border: none; padding: 15px 20px; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 1rem;">Remove PIN</button>' +
                '<button onclick="closeModal()" style="background: #6c757d; color: white; border: none; padding: 15px 20px; border-radius: 10px; cursor: pointer; font-weight: bold; font-size: 1rem;">Cancel</button>' +
                '</div>';
                
            modal.appendChild(content);
            document.body.appendChild(modal);
            
            // Focus the PIN input after a brief delay
            setTimeout(() => {
                const pinInput = document.getElementById('newPIN');
                if (pinInput) pinInput.focus();
            }, 100);
        }
        
        // Save PIN
        function savePIN(studentId, studentName) {
            const pin = document.getElementById('newPIN').value.trim();
            
            if (!pin) {
                alert('‚ùå Please enter a PIN');
                return;
            }
            
            if (pin.length !== 4 || !/^\d{4}$/.test(pin)) {
                alert('‚ùå PIN must be exactly 4 digits');
                return;
            }
            
            // In production, this would call the API to save the PIN
            // For now, just show success message
            alert('‚úÖ PIN set for ' + studentName + '!\n\nPIN: ' + pin + '\n\nThey will need to enter this when logging in.');
            closeModal();
            
            // TODO: Call API to actually save the PIN
            // fetch(`${API_URL}/parent/student/${studentId}`, {
            //     method: 'PUT',
            //     headers: {
            //         'Authorization': `Bearer ${token}`,
            //         'Content-Type': 'application/json'
            //     },
            //     body: JSON.stringify({ pin_code: pin })
            // });
        }
        
        // Remove PIN
        function removePIN(studentId, studentName) {
            if (confirm('Remove PIN for ' + studentName + '?\n\nThey will no longer need a PIN to log in.')) {
                alert('‚úÖ PIN removed for ' + studentName);
                closeModal();
                
                // TODO: Call API to remove the PIN
                // fetch(`${API_URL}/parent/student/${studentId}`, {
                //     method: 'PUT',
                //     headers: {
                //         'Authorization': `Bearer ${token}`,
                //         'Content-Type': 'application/json'
                //     },
                //     body: JSON.stringify({ pin_code: null })
                // });
            }
        }
        
        // Edit student
        function editStudent(studentId, studentName, currentAge, currentGrade) {
            console.log('Edit clicked for:', studentName);
            
            const modal = document.createElement('div');
            modal.id = 'editModal';
            modal.style.position = 'fixed';
            modal.style.top = '0';
            modal.style.left = '0';
            modal.style.width = '100%';
            modal.style.height = '100%';
            modal.style.background = 'rgba(0,0,0,0.8)';
            modal.style.display = 'flex';
            modal.style.justifyContent = 'center';
            modal.style.alignItems = 'center';
            modal.style.zIndex = '10001';
            
            const content = document.createElement('div');
            content.style.background = 'white';
            content.style.borderRadius = '20px';
            content.style.padding = '30px';
            content.style.maxWidth = '500px';
            content.style.width = '90%';
            
            content.innerHTML = 
                '<h2 style="margin: 0 0 20px 0; color: #1B2A30;">‚úèÔ∏è Edit ' + studentName + '</h2>' +
                '<div style="margin-bottom: 15px;"><label style="display: block; font-weight: bold; margin-bottom: 5px;">Student Name:</label><input type="text" id="editName" value="' + studentName + '" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;"></div>' +
                '<div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">' +
                '<div><label style="display: block; font-weight: bold; margin-bottom: 5px;">Age:</label><input type="number" id="editAge" value="' + currentAge + '" min="3" max="18" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;"></div>' +
                '<div><label style="display: block; font-weight: bold; margin-bottom: 5px;">Grade:</label><select id="editGrade" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px;"><option value="K">Kindergarten</option><option value="1st Grade">1st Grade</option><option value="2nd Grade">2nd Grade</option><option value="3rd Grade">3rd Grade</option><option value="4th Grade">4th Grade</option><option value="5th Grade">5th Grade</option><option value="6th Grade">6th Grade</option><option value="7th Grade">7th Grade</option><option value="8th Grade">8th Grade</option><option value="High School">High School</option><option value="College Prep">College Prep</option></select></div>' +
                '</div>' +
                '<div style="margin-bottom: 20px;"><label style="display: block; font-weight: bold; margin-bottom: 5px;">Notes:</label><textarea id="editNotes" rows="3" style="width: 100%; padding: 12px; border: 2px solid #ddd; border-radius: 8px; font-size: 16px; resize: vertical;" placeholder="Learning goals, preferences..."></textarea></div>' +
                '<div style="display: flex; gap: 15px; justify-content: flex-end;">' +
                '<button onclick="closeModal()" style="background: #1B2A30; color: white; border: none; padding: 12px 25px; border-radius: 8px; cursor: pointer;">Cancel</button>' +
                '<button onclick="saveChanges(\'' + studentId + '\')" style="background: #305853; color: white; border: none; padding: 12px 25px; border-radius: 8px; cursor: pointer;">Save</button>' +
                '</div>';
                
            modal.appendChild(content);
            document.body.appendChild(modal);
            
            // Set current grade
            document.getElementById('editGrade').value = currentGrade;
        }
        
        // Save changes
        function saveChanges(studentId) {
            const name = document.getElementById('editName').value;
            const age = document.getElementById('editAge').value;
            const grade = document.getElementById('editGrade').value;
            const notes = document.getElementById('editNotes').value;
            
            if (!name || !age) {
                alert('‚ùå Please fill in all required fields.');
                return;
            }
            
            // Find and update the student card
            const studentCards = document.querySelectorAll('.student-card');
            studentCards.forEach(card => {
                const editBtn = card.querySelector('.action-btn.edit');
                if (editBtn && editBtn.getAttribute('onclick').includes("'" + studentId + "'")) {
                    // Update name
                    const nameElement = card.querySelector('.student-name');
                    if (nameElement) {
                        const icon = nameElement.textContent.split(' ')[0]; // Keep the icon
                        nameElement.textContent = icon + ' ' + name + ' (' + age + ')';
                    }
                    
                    // Update grade badge
                    const gradeElement = card.querySelector('.student-grade');
                    if (gradeElement) {
                        gradeElement.textContent = grade;
                    }
                    
                    // Update the edit button to use new values
                    editBtn.setAttribute('onclick', `editStudent('${studentId}', '${name}', ${age}, '${grade}')`);
                }
            });
            
            alert('‚úÖ ' + name + ' updated successfully!\n\nName: ' + name + '\nAge: ' + age + '\nGrade: ' + grade);
            closeModal();
        }
        
        // Delete student - with API call
        async function deleteStudent(studentId, studentName) {
            console.log('Delete clicked for:', studentName);
            
            const confirmed = confirm('üóëÔ∏è Delete ' + studentName + '?\n\nThis will remove them from your Mountain Climbers and delete their progress.\n\nThis action cannot be undone.\n\nClick OK to delete, Cancel to keep them.');
            
            if (confirmed) {
                // Note: This is the demo dashboard with hardcoded students
                // For the live version with API, see parent-dashboard-live.html
                
                // Find and remove the student card from the display
                const studentCards = document.querySelectorAll('.student-card');
                studentCards.forEach(card => {
                    const nameElement = card.querySelector('.student-name');
                    if (nameElement && nameElement.textContent.includes(studentName)) {
                        // Add fade out animation
                        card.style.transition = 'all 0.3s ease';
                        card.style.transform = 'scale(0.8)';
                        card.style.opacity = '0';
                        
                        // Remove the card after animation
                        setTimeout(() => {
                            card.remove();
                            alert('‚úÖ ' + studentName + ' has been deleted from your Mountain Climbers.\n\n‚ö†Ô∏è Note: This is the demo dashboard. Students will reappear on refresh. Use parent-dashboard-live.html for permanent deletion.');
                        }, 300);
                    }
                });
                
                console.log('Student deleted (demo mode):', studentId, studentName);
            }
        }
        
        // Close modal
        function closeModal() {
            const loginModal = document.getElementById('loginModal');
            const editModal = document.getElementById('editModal');
            const pinModal = document.getElementById('pinModal');
            
            if (loginModal) loginModal.remove();
            if (editModal) editModal.remove();
            if (pinModal) pinModal.remove();
        }
        
        // View student details
        function viewStudent(studentId) {
            window.location.href = `student-detail.html?id=${studentId}`;
        }
        
        // Close modal when clicking outside
        document.addEventListener('click', function(e) {
            if (e.target.id === 'loginModal' || e.target.id === 'editModal' || e.target.id === 'pinModal') {
                closeModal();
            }
        });
        
        // Make student cards clickable (except for buttons)
        document.addEventListener('DOMContentLoaded', function() {
            const studentCards = document.querySelectorAll('.student-card');
            studentCards.forEach((card, index) => {
                const studentIds = ['emmett', 'lucas', 'asher', 'levi', 'riley', 'bryton'];
                card.addEventListener('click', function(e) {
                    // Don't navigate if clicking on a button
                    if (e.target.tagName !== 'BUTTON' && !e.target.closest('button')) {
                        viewStudent(studentIds[index]);
                    }
                });
            });
        });
    </script>
</body>
</html>